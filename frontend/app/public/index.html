<!doctype html>

<!-- 

This HTML page contains the bare minimum stuff required for the emscripten code to work.
Well that's not entirely true we could get rid of everything except the canvas, but at least
for debugging we want everything here. When we do the final release we can remove everything except the canvas.

The front-end team will probably also need to add the UI here, then in javascript detect when a UI element has been interacted with, and use ccall()
to call some C++ function the backend team will write.

-->

<html lang="en-us" xmlns="http://www.w3.org/1999/html">

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Main HTML Page</title>
    <link rel="stylesheet" type="text/css" href="./style.css">
    <link rel="shortcut icon" href="#">

    <!-- Override default encoding to support binary files-->
    <script>TextEncoder = TextDecoder = null</script>
    <script src="https://cdn.jsdelivr.net/gh/inexorabletash/text-encoding@master/lib/encoding-indexes.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/inexorabletash/text-encoding@master/lib/encoding.js"></script>
  </head>

  <body>
  <!-- Nav Bar -->
  <div id="navbar" class="navbar">
    <p id="title"> OrthoFreeD </p>
    <ul id = "help">
      <li><a class ="help" href="">Help</a></li>
    </ul>
  </div>

  <!-- Toolbar -->
  <div class ="toolbar" id ="toolbar">
    <a href="#" class="backbtn">&#8617;</a>
    <div class="tool"
         role="button"
         tabindex="0">Import
    </div>
    <div class="tool"
         role="button"
         tabindex="-1">Export
    </div>
    <div class="dropdown">
      <button class="tool">View</button>
      <div class="menu-items">
        <a href="#">Item 1</a>
        <a href="#">Item 2</a>
        <a href="#">Item 3</a>
      </div>
    </div>
    <div class="dropdown">
      <button class="tool">Edit</button>
      <div class="menu-items">
        <a href="#">Item 1</a>
        <a href="#">Item 2</a>
        <a href="#">Item 3</a>
      </div>
    </div>
    <div class="dropdown">
      <button class="tool">Select</button>
      <div class="menu-items">
        <a href="#">Item 1</a>
        <a href="#">Item 2</a>
        <a href="#">Item 3</a>
      </div>
    </div>
  </div>

	<!-- A progress display to indicate the webassembly code is still being loaded -->
    <figure style="overflow:visible;" id="spinner"><div class="spinner"></div><h1>emscripten</h1></figure>
    <div class="emscripten" id="status">Downloading...</div>
    <div class="emscripten">
      <progress value="0" max="100" id="progress" hidden></progress>
    </div>
	
	<!-- The canvas, the most important tag -->
    <div class="emscripten_border">
      <canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()" tabindex=-1></canvas>
    </div>
	
	<!-- Debug Buttons to mess with the canvas -->
    <hr/>
    <div class="emscripten">
      <input type="checkbox" id="resize">Resize canvas
      <input type="checkbox" id="pointerLock" checked>Lock/hide mouse pointer
      <input type="button" value="Fullscreen" onclick="Module.requestFullscreen(document.getElementById('pointerLock').checked, 
                                                                                document.getElementById('resize').checked)">
    </div>

    <!--root React component-->
    <div id="root"></div>
    
	<!-- Debug panel, basically cout. -->
    <hr/>
    <textarea class="emscripten" id="output" rows="8"></textarea>
    <hr>
	
	<!-- The backend scripts -->
    <script type='text/javascript' src="debug_elements.js"></script>
    <script type="text/javascript" src="backend.js"></script>
	
	<!-- Testing ways to call C functions from Javascript -->
	<script>
		Module.onRuntimeInitialized = () => {
		setTimeout(function() { 
			//make sure backend code has initialized first
			while(!_is_ready()) {}
			//then call c++ code
			_print_hello(5);
			_print_hello(15);
			_print_hello(25);
		}, 1);
		}
	</script>

    <!-- Initialization check is done on backend -->
    <input type='number' id='scale_entity' value=100>Scale by %</input>
    <button onclick='_scale(document.getElementById("scale_entity").value / 100)'>Scale</button>
  </body>
</html>